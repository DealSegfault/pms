# Order Management System (OMS)

This module implements a market making Order Management System that listens for quotes from Redis and places orders on supported exchanges.

## Architecture

The OMS consists of several key components:

1. **Quote Consumption**: Listens for quotes generated by the quote generator via Redis pub/sub
2. **Order Management**: Places, cancels, and tracks orders on exchanges
3. **Market Making Strategy**: Simple market making logic that determines when to place/update orders

## Setup

1. Make sure you have a Redis server running locally
2. Set up environment variables (create or update `.env` file):

```
COINCALL_API_KEY=your_coincall_api_key
COINCALL_API_SECRET=your_coincall_secret_key
BINANCE_API_KEY=your_binance_api_key
BINANCE_API_SECRET=your_binance_secret_key
```

3. Install required packages:

```bash
pip install -r ../requirements.txt
```

## Usage

### Starting the System

To run the complete system, you need to start three components:

1. **Market Data Collector**: Fetches and processes orderbook data
   ```bash
   cd market_data
   python main.py
   ```

2. **User Stream Listener**: Listens for user position and trade updates
   ```bash
   cd oms
   python user_stream.py
   ```

3. **Order Management System**: Processes quotes and places orders
   ```bash
   cd oms
   python main.py
   ```

### Configuration

You can modify the following parameters in main.py:

- `symbols`: List of symbols to trade
- `exchanges`: List of exchanges to trade on
- Spread factor and other market making parameters in the `process_quote` method

## How It Works

1. The market data collector fetches orderbook data from exchanges and stores it in Redis
2. The quote generator (simple_quote.py) processes this data to generate optimal bid/ask quotes
3. The OMS listens for these quotes via Redis pub/sub
4. When a new quote is received, the OMS:
   - Evaluates if the current orders need to be updated
   - Cancels existing orders if necessary
   - Places new orders with the updated prices/sizes
   - Tracks all active orders

## Monitoring

The OMS logs all significant events to the console. You can adjust the logging level in `main.py`.

## Next Steps

- Implement more sophisticated market making strategies
- Add position and risk management
- Enhance error handling and recovery mechanisms
- Create a web dashboard for monitoring 